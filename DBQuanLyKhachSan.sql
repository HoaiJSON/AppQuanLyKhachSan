-- Tạo cơ sở dữ liệu
CREATE DATABASE QuanLyKhachSan;

-- Sử dụng cơ sở dữ liệu
USE QuanLyKhachSan;
-- Bảng chức vụ
CREATE TABLE CHUCVU (
    MACHUCVU VARCHAR(100) PRIMARY KEY NOT NULL,
    TENCHUCVU NVARCHAR(250) NOT NULL
);

-- Bảng chi nhánh
CREATE TABLE CHINHANH (
    MACHINHANH VARCHAR(100) PRIMARY KEY NOT NULL,
    TENCHINHANH NVARCHAR(250) NOT NULL,
    DIACHI NVARCHAR(250) NOT NULL,
    SODIENTHOAI NVARCHAR(15) NOT NULL
);


-- Cập nhật bảng NHANVIEN
CREATE TABLE NHANVIEN (
    MANHANVIEN VARCHAR(100) PRIMARY KEY NOT NULL,
    TENNHANVIEN NVARCHAR(250) NOT NULL,
    SODIENTHOAI NVARCHAR(15) NOT NULL,
    DIACHI NVARCHAR(250) NOT NULL,
    GIOITINH NVARCHAR(3) NOT NULL,
	CCCD VARCHAR(100) NOT NULL,
    EMAIL NVARCHAR(250) NOT NULL,
    MACHUCVU VARCHAR(100) NOT NULL,
	MACHINHANH VARCHAR(100) NOT NULL,
	FOREIGN KEY (MACHINHANH) REFERENCES CHINHANH (MACHINHANH),
    FOREIGN KEY (MACHUCVU) REFERENCES CHUCVU(MACHUCVU)
);

-- Bảng tài khoản
CREATE TABLE TAIKHOAN (
    TENDANGNHAP NVARCHAR(250) PRIMARY KEY NOT NULL,
    MATKHAU NVARCHAR(250) NOT NULL,
    MANHANVIEN VARCHAR(100) NOT NULL,
    FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN)
);



-- Bảng khách hàng
CREATE TABLE KHACHHANG (
    MAKHACHHANG VARCHAR(100) PRIMARY KEY NOT NULL,
    TENKHACHHANG NVARCHAR(250) NOT NULL,
    DIENTHOAI NVARCHAR(15) NOT NULL,
    QUOCTICH NVARCHAR(250) NOT NULL,
    GIOITINH NVARCHAR(10) NOT NULL,
    NGAYSINH NVARCHAR(20) NOT NULL,
    CCCD NVARCHAR(250) NOT NULL,
    DIACHI NVARCHAR(350) NOT NULL,
    MACHINHANH VARCHAR(100) NOT NULL,
    FOREIGN KEY (MACHINHANH) REFERENCES CHINHANH(MACHINHANH)
);

-- Bảng phòng
CREATE TABLE PHONG (
    MAPHONG VARCHAR(100) PRIMARY KEY NOT NULL,
    SOPHONG NVARCHAR(250) NOT NULL,
    LOAIPHONG NVARCHAR(250) NOT NULL,
    LOAIGIUONG NVARCHAR(250) NOT NULL,
    HINHANH VARBINARY(MAX) NULL,
    MOTA NVARCHAR(MAX) NULL,
    GIA INT NOT NULL,
    MACHINHANH VARCHAR(100) NOT NULL,
    TRANGTHAI NVARCHAR(50) DEFAULT (N'TRỐNG'),
	KHACHHANGONLINE INT NULL,--Nếu như khách hàng online bằng null thì sao còn khác null thì sao
	GHICHU NVARCHAR(MAX),--Ở đây nếu ghi thông tin khách hàng thì nên ghi cái gì tên và số điện thoại à 
	THOIGIANUPDATE date ,
    FOREIGN KEY (MACHINHANH) REFERENCES CHINHANH(MACHINHANH)
); --TRANG THAI (DA DAT,TRONG,DANG SU DUNG,BAOTRI)

-- Bảng đặt phòng
CREATE TABLE DATPHONG (
    MADATPHONG VARCHAR(100) PRIMARY KEY NOT NULL,
    MAKHACHHANG VARCHAR(100) NOT NULL,
    MAPHONG VARCHAR(100) NOT NULL,
	NGAYDANGKY DATE NOT NULL,
    NGAYCHECKIN DATE NOT NULL,
    NGAYCHECKOUT DATE NULL,
    TRANGTHAI NVARCHAR(50) DEFAULT (N'CHƯA THANH TOÁN'),
    FOREIGN KEY (MAKHACHHANG) REFERENCES KHACHHANG(MAKHACHHANG),
    FOREIGN KEY (MAPHONG) REFERENCES PHONG(MAPHONG),
);

CREATE TABLE NHACUNGCAP (
	MANCC VARCHAR(100) PRIMARY KEY NOT NULL,
	TENNCC NVARCHAR(100) NOT NULL,
	DIACHI NVARCHAR(500) NOT NULL,
	EMAIL VARCHAR(250) NOT NULL,
	SDT INT NOT NULL,
);

-- Bảng nguồn KHO
CREATE TABLE KHO (
    MAKHO VARCHAR(100) PRIMARY KEY NOT NULL,
    TENHANG NVARCHAR(250) NOT NULL,
    SOLUONG INT NOT NULL,
    GIADONVI INT,
    GIATRITONG INT,
	DONVITINH NVARCHAR(50),
    NGAYNHAPHANG NVARCHAR(100) NOT NULL,
    DANHMUC NVARCHAR(100) NOT NULL,
    NGAYCAPNHAT NVARCHAR(100) NOT NULL,
    MANCC VARCHAR(100) NOT NULL,
    FOREIGN KEY (MANCC) REFERENCES NHACUNGCAP(MANCC),

);
-- Bảng dịch vụ
CREATE TABLE DICHVU (
    MADICHVU VARCHAR(100) PRIMARY KEY NOT NULL,
    TENDICHVU NVARCHAR(250) NOT NULL,
    HINHANH VARBINARY(MAX) NULL,
    GIA INT NOT NULL,
    SOLUONG INT NULL,
    DONVITINH NVARCHAR(50) NULL,
    MACHINHANH VARCHAR(100) NOT NULL,
	MAKHO VARCHAR(100),
	FOREIGN KEY (MAKHO) REFERENCES KHO(MAKHO),
    FOREIGN KEY (MACHINHANH) REFERENCES CHINHANH(MACHINHANH),
);



-- Bảng chi tiết dịch vụ
CREATE TABLE CHITIETDICHVU (
    MAKHACHHANG VARCHAR(100) NOT NULL,
    MADICHVU VARCHAR(100) NOT NULL,
    MANHANVIEN VARCHAR(100) NOT NULL,
    SOLUONG NVARCHAR(250) NOT NULL,
    NGAYSUDUNG NVARCHAR(250) NULL,
	MADATPHONG VARCHAR(100) NOT NULL,
    PRIMARY KEY(MAKHACHHANG, MADICHVU,MADATPHONG),
    FOREIGN KEY (MAKHACHHANG) REFERENCES KHACHHANG(MAKHACHHANG),
    FOREIGN KEY (MADICHVU) REFERENCES DICHVU(MADICHVU),
    FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN),
	FOREIGN KEY (MADATPHONG) REFERENCES DATPHONG(MADATPHONG),
);



-- Bảng hóa đơn
CREATE TABLE HOADON (
    MAHD VARCHAR(100) PRIMARY KEY NOT NULL,
    MANHANVIEN VARCHAR(100) NOT NULL,
    MADATPHONG VARCHAR(100) NOT NULL,
    MAKHACHHANG VARCHAR(100) NOT NULL,
    TONGTIEN INT NOT NULL,
    NGAYLAP DATE NOT NULL, 
    FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN),
    FOREIGN KEY (MADATPHONG) REFERENCES DATPHONG(MADATPHONG),
    FOREIGN KEY (MAKHACHHANG) REFERENCES KHACHHANG(MAKHACHHANG)
);


CREATE TABLE CHITIETHOADON (
    MAHD VARCHAR(100) NOT NULL,
    MADICHVU VARCHAR(100) NOT NULL,
    SOLUONG INT NOT NULL,
    GIA BIGINT NOT NULL,
    PRIMARY KEY (MAHD, MADICHVU),
    FOREIGN KEY (MAHD) REFERENCES HOADON(MAHD),
    FOREIGN KEY (MADICHVU) REFERENCES DICHVU(MADICHVU)
);


---- Nhập thêm dữ liệu mẫu cho bảng chức vụ
INSERT INTO CHUCVU (MACHUCVU, TENCHUCVU) VALUES 
('CV001', N'Kế toán'),
('CV002', N'Quản lý'),
('CV003', N'Nhân viên bảo vệ'),
('CV004', N'Nhân viên dọn phòng');

-- Nhập thêm dữ liệu mẫu cho bảng chi nhánh
INSERT INTO CHINHANH (MACHINHANH, TENCHINHANH, DIACHI, SODIENTHOAI) VALUES 
('CN001', N'Chi nhánh 1', N'789 Đường LMN, Đà Nẵng', '0911111111'),
('CN002', N'Chi nhánh 2', N'101 Đường QRS, Hải Phòng', '0922222222');

-- Nhập thêm dữ liệu mẫu cho bảng nhân viên
INSERT INTO NHANVIEN (MANHANVIEN, TENNHANVIEN, SODIENTHOAI, DIACHI, GIOITINH, CCCD, EMAIL, MACHUCVU, MACHINHANH) VALUES 
('NV001', N'Lê Văn C', '0911111111', N'789 Đường LMN', N'Nam', '3818381838', 'lvc@gmail.com', 'CV001', 'CN001'),
('NV002', N'Hồ Thị D', '0922222222', N'101 Đường QRS', N'Nữ', '2819281928', 'htd@gmail.com', 'CV002', 'CN001'),
('NV003', N'Phạm Văn E', '0933333333', N'202 Đường TUV', N'Nam', '1828182818', 'pve@gmail.com', 'CV004', 'CN001'),
('NV004', N'Nguyễn Thị F', '0944444444', N'303 Đường WXY', N'Nữ', '7821782178', 'ntf@gmail.com', 'CV004', 'CN001'),
('NV005', N'Trần Văn G', '0955555555', N'404 Đường ZAA', N'Nam', '4829482948', 'tvg@gmail.com', 'CV004', 'CN001'),
('NV006', N'Hoàng Thị H', '0966666666', N'505 Đường BBC', N'Nữ', '9813981398', 'hth@gmail.com', 'CV003', 'CN001'),
('NV007', N'Vũ Văn I', '0977777777', N'606 Đường DDD', N'Nam', '7812781278', 'vvi@gmail.com', 'CV002', 'CN002'),
('NV008', N'Phan Thị J', '0988888888', N'707 Đường EEE', N'Nữ', '9819819819', 'ptj@gmail.com', 'CV001', 'CN002'),
('NV009', N'Lý Văn K', '0999999999', N'808 Đường FFF', N'Nam', '9912991299', 'lvk@gmail.com', 'CV003', 'CN002');

-- Nhập thêm dữ liệu mẫu cho bảng phòng
INSERT INTO PHONG (MAPHONG, SOPHONG, LOAIPHONG, LOAIGIUONG, GIA, MACHINHANH) VALUES 
('PV001', 103, N'Thường', N'Giường đơn', 200000, 'CN001'),
('PV002', 104, N'Thường', N'Giường đôi', 300000, 'CN001'),
('PV003', 105, N'VIP', N'Giường đôi', 600000, 'CN001'),
('PV004', 106, N'Thường', N'Giường đơn', 250000, 'CN001'),
('PV005', 107, N'VIP', N'Giường đơn', 550000, 'CN001'),
('PV006', 108, N'Thường', N'Giường đôi', 350000, 'CN002'),
('PV007', 109, N'Thường', N'Giường đơn', 220000, 'CN002'),
('PV008', 110, N'Thường', N'Giường đôi', 370000, 'CN002');

-- Nhập thêm dữ liệu mẫu cho bảng NHACUNGCAP
INSERT INTO NHACUNGCAP (MANCC, TENNCC, DIACHI, EMAIL, SDT) VALUES 
('NCC001', N'Nhà cung cấp D', N'202 Đường TUV, Cần Thơ', 'ncc_d@gmail.com', '0912345678'),
('NCC002', N'Nhà cung cấp E', N'303 Đường WXY, Huế', 'ncc_e@gmail.com', '0912345679'),
('NCC003', N'Nhà cung cấp F', N'404 Đường ZAA, Nha Trang', 'ncc_f@gmail.com', '0912345680');

-- Nhập thêm dữ liệu mẫu cho bảng KHO
INSERT INTO KHO (MAKHO, TENHANG, SOLUONG, GIADONVI, GIATRITONG, DONVITINH, NGAYNHAPHANG, DANHMUC, NGAYCAPNHAT, MANCC) VALUES 
('SP001', N'Nước uống', 300, 10000, 3000000, N'Chai', '2024-10-04', N'Đồ uống', '2024-10-04', 'NCC001'),
('SP002', N'Bánh kẹo', 150, 15000, 2250000, N'Gói', '2024-10-05', N'Thực phẩm', '2024-10-05', 'NCC002');

-- Nhập thêm dữ liệu mẫu cho bảng DICHVU
INSERT INTO DICHVU (MADICHVU, TENDICHVU, HINHANH, GIA, SOLUONG, DONVITINH, MACHINHANH, MAKHO) VALUES 
('DV001', N'Nước uống', NULL, 15000, 300, N'Chai', 'CN001', 'SP001'),
('DV002', N'Bánh kẹo', NULL, 20000, 150, N'Gói', 'CN001', 'SP002');

-- Nhập thêm dữ liệu mẫu cho bảng TAIKHOAN
INSERT INTO TAIKHOAN VALUES 
('nguyenvana', '123456', 'NV001'),
('lethid', '123456', 'NV002'),
('phamvane', '123456', 'NV003'),
('nguyenthif', '123456', 'NV004'),
('tranvang', '123456', 'NV005'),
('hoangthih', '123456', 'NV006'),
('vuvanI', '123456', 'NV007'),
('phanthij', '123456', 'NV008'),
('lyvank', '123456', 'NV009');
SELECT * FROM DATPHONG
select * from CHINHANH
SELECT * FROM CHITIETDICHVU 
SELECT * FROM DICHVU
select * from NHANVIEN
Select * from TAIKHOAN
select * from KHACHHANG
Select * from NHACUNGCAP
select * from HOADON
SELECT * FROM CHITIETHOADON
select * from KHO
select * from PHONG

update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV001'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV002'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV003'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV004'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV005'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV006'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV007'
update PHONG set MOTA = N'Quạt, máy điều hòa, Wifi, Tivi' where MAPHONG = 'PV008'